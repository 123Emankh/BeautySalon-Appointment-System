<?php
global $conn;
session_start();
require "db.php";

// ØªØ­Ù‚Ù‚ Ø¥Ù† Ø§Ù„Ø£Ø¯Ù…Ù† Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ (ØºÙŠØ±ÙŠ Ø§Ù„Ø´Ø±Ø· Ø­Ø³Ø¨ Ø§Ù„ÙƒÙˆØ¯ Ø¨ØªØ§Ø¹Ùƒ Ù„Ùˆ Ù„Ø§Ø²Ù…)
if (!isset($_SESSION["role"]) || $_SESSION["role"] !== "admin") {
    header("Location: admin-login.php");
    exit();
}

$error = "";
$success = "";

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $name = trim($_POST["name"] ?? "");
    $category = trim($_POST["category"] ?? "");
    $description = trim($_POST["description"] ?? "");
    $price = floatval($_POST["price"] ?? 0);
    $stock = intval($_POST["stock"] ?? 0);
    $image_url = trim($_POST["image_url"] ?? "");
    $active = isset($_POST["active"]) ? 1 : 0;

    if ($name === "" || $price <= 0 || $stock < 0) {
        $error = "Ø§Ù…Ù„Ø¦ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ© ØµØ­ (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†).";
    } else {
        $stmt = $conn->


<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ - Ø¥Ù…Ø§Ù„ÙŠÙ† ØµØ§Ù„ÙˆÙ†</title>
    <link rel="stylesheet" href="style.css"/>
    <style>
        body {background:#fdf8f5; font-family: 'Cairo', sans-serif;}
        .wrap {max-width:600px; margin:40px auto; padding:20px; background:#fff; border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,0.08);}
        .input-group {margin-bottom:16px;}
        label {display:block; margin-bottom:6px; font-weight:700; color:#4b2c4f;}
        input, textarea {width:100%; padding:10px; border:1px solid #ddd; border-radius:12px;}
        button {background:#6d3a75; color:#fff; padding:12px 24px; border:none; border-radius:999px; cursor:pointer; font-weight:700;}
        .msg {padding:12px; border-radius:12px; margin-bottom:20px; font-weight:700;}
        .success {background:#d4edda; color:#155724;}
        .error {background:#f8d7da; color:#721c24;}
    </style>
</head>
<body>
<div class="wrap">
    <h1 style="text-align:center; color:#4b2c4f;">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ ğŸ›ï¸</h1>

    <?php if ($success !== ""): ?>
    <div class="msg success"><?= $success ?></div>
    <?php endif; ?>
    <?php if ($error !== ""): ?>
    <div class="msg error"><?= $error ?></div>
    <?php endif; ?>

    <form method="POST">
        <div class="input-group">
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ *</label>
            <input type="text" name="name" required placeholder="Ù…Ø«Ù„: Ø´Ø§Ù…Ø¨Ùˆ Ù…ØºØ°ÙŠ">
        </div>

        <div class="input-group">
            <label>Ø§Ù„ÙØ¦Ø©</label>
            <input type="text" name="category" placeholder="Ù…Ø«Ù„: Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø´Ø¹Ø±">
        </div>

        <div class="input-group">
            <label>Ø§Ù„ÙˆØµÙ</label>
            <textarea name="description" rows="4" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬..."></textarea>
        </div>

        <div class="input-group">
            <label>Ø§Ù„Ø³Ø¹Ø± (â‚ª) *</label>
            <input type="number" step="0.01" name="price" required placeholder="99.90">
        </div>

        <div class="input-group">
            <label>Ø§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† *</label>
            <input type="number" name="stock" required placeholder="50">
        </div>

        <div class="input-group">
            <label>Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (URL)</label>
            <input type="text" name="image_url" placeholder="https://example.com/image.jpg">
            <small>Ù…Ø«Ù„Ø§Ù‹ ØµÙˆØ±Ø© Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø£Ùˆ Ø±ÙØ¹Ù‡Ø§ Ø¹Ù„Ù‰ imgur.com</small>
        </div>

        <div class="input-group">
            <label><input type="checkbox" name="active" checked> Ù…ÙØ¹Ù‘Ù„ (ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø±)</label>
        </div>

        <button type="submit">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
    </form>

    <div style="text-align:center; margin-top:20px;">
        <a href="shop.php">Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…ØªØ¬Ø±</a> |
        <a href="admin-dashboard.php">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
    </div>
</div>
</body>
</html>